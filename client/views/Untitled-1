<template>
  <div class="view-guest" :auto-track-mounted="pv" v-show="showPage">
    <div class="screen" :class="{ active: !$isPassenger }">
      <div class="notice">
        <div class="log"></div>
        <div class="text">
          <span class="detail-nprmal">您好，滴水贷服务逐步开放中，敬请期待。为表歉意，</span>
          <span class="detail-color">特赠送您保额为10万的资金账户安全险。</span>
        </div>
      </div>
      <div class="but">
        <button v-if="buttonText" class="view-button" @click="jumpAdd">账户资金安全险免费领取</button>
        <button v-else class="view-button" @click="jumpCheck">查看我的资金账户安全险</button>
      </div>
    </div>
  </div>
</template>
<script>

import { assembleUrl } from '../utils/url'

export default {
    
  data () {
    return {
      showPage: false,
      buttonText: true,
      isClick: false,
      payOrderId: 0
    }
  },
  created() {
    this.$request({
      uri: 'nonwhite/user',
      method: "POST"
    })
    .then(result => {
      if (result.policy !== null) {
          this.buttonText = false;
      } else {
          this.buttonText = true;
      }
      this.payOrderId = result.payOrderId;
      this.showPage = true;
    })
    .catch(err => {
      err.message = `获取信息失败:${err}`
    })
  },
  computed: {
    pv() {
      return JSON.stringify({
        e: 'biopen',
        attrs: {
          page_name: 'guest_page',
          status: window.INIT_DATA.status
        }
      })
    }
  },
  methods: {
    jumpAdd() {
      // location.href = assembleUrl('http://10.94.112.50:9109/ivannew/activity', //线下
      location.href = assembleUrl('//manhattan.webapp.xiaojukeji.com/ivannew/activity', //线上
      {
        ...this.$route.query, 
        productId: 3170769885554753538,
      })
    },
    jumpCheck() {
      // location.href = assembleUrl('http://10.94.112.50:9109/ivannew/orderdetail',   
      location.href = assembleUrl('//manhattan.webapp.xiaojukeji.com/ivannew/orderdetail', 
      {
        ...this.$route.query, 
        payOrderIds: this.payOrderId,
      })
    },
  }
}
</script>
<style lang="stylus" scoped>
.view-guest
  position absolute
  left 0
  right 0
  top 0
  bottom 0
  .screen
    width 100%
    height 100%
    position relative
    background  url(../assets/images/nonwhite-passenger.jpg) no-repeat center
    background-size 100% 100%
    .notice
      position absolute
      width 6.70rem
      height 1.53rem
      margin 0 .40rem
      background rgba(249,250,251,0.85)
      border-radius 4px
      bottom 1.76rem
      .log
        float left
        background url(../assets/images/notice-icon.png) no-repeat center
        background-size 100% 100%
        margin-left 0.40rem
        margin-top 0.57rem
        width 0.40rem
        height 0.40rem
      .text
        font-family PingFangSC-Light
        font-size 0.26rem
        color #41485D
        letter-spacing 0
        line-height 0.35rem
        margin .24rem .40rem .24rem 1.04rem
        text-align left
        .detail-color
          color #FB7E36
    .but
      position absolute
      bottom 0.36rem
      margin 0 .40rem
      button
        text-align center
        width 6.70rem
        height 1.00rem
        background: linear-gradient(to right, #7FB3FF, #2F86F6); 
        border-radius: 4px;
        font-family  PingFangSC-Medium
        font-size .36rem
        color #FFFFFF
        line-height 1rem
        &:active
          background #2F86F6
  .active
    background  url(../assets/images/nonwhite-dirver.jpg) no-repeat center
    background-size 100% 100%
</style>
